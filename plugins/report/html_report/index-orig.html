<!DOCTYPE html>
<html lang="en">
	<head>
		<title>GoLismero Report</title> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" type="text/css" href="./css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="./css/report.css">
		<link rel="stylesheet" type="text/css" href="./css/jquery.jqplot.min.css">
		<link rel="stylesheet" type="text/css" href="./css/stylesHighlight/default.css">
	</head>
	<body>
		<div class="navbar navbar-inverse " role="navigation">
	      <div class="container">
	        <div class="navbar-header">
	          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	          </button>
	          <div class="pull-left logo">
	          <a href="quickInfo" class="anchor"><img height="60px"src="data:image/png;base64,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"/></a></div>
	          <div class="navbar-brand">GoLismero report</div>
	        </div>
	        <div class="collapse navbar-collapse">
	          <ul class="nav navbar-nav">
				
				<li><a href="vulnerabilitiesTable" class="anchor">Vulnerabilities</a></li>
	            <li><a href="technicalReportTable" class="anchor">Technical report</a></li>
	          </ul>
	        </div><!-- /.nav-collapse -->	        
	      </div><!-- /.container -->
	    </div>
	    <div class="headerPrint ">
			<h1>GoLismero Report</h1>
	    </div>
		<div class="container">
			<div class="lateralNavbar" id="lateralNavbar">
				<span class="text bold">Menu</span>
				<ul>
					<li><a href="vulnerabilitiesTable" class="anchor" ><span class="glyphicon glyphicon-th-list"></span></a></li>
					<li><a href="technicalReportTable" class="anchor" ><span class="glyphicon glyphicon-exclamation-sign" ></span></a></li>
				</ul>
			</div>
			<div class="row" data-anchor="quickInfo">
				<div class="col-sm-4 ">
					<div class="well quickInfo">
						<span class="glyphicon glyphicon-record"></span>
						<div class="text-right info-links">
							<p class="title">Targets</p>
							<ul id="targetsResume">
								
							</ul>
						</div>
					</div>
				</div>
				<div class="col-sm-4 " >
					<div class="well quickInfo">
						<span class="glyphicon glyphicon-time"></span>
						<div class="text-right info-links">
							<p class="title">Time</p>
							<p class="info"><span class="bold">Start:</span> <span id="startResume"></span></p>
							<p class="info"><span class="bold">End:</span> <span id="endResume"></span></p>
							<p class="info"><span class="bold">Total:</span><span id="totalResume"></span></p>
						</div>

					</div>
				</div>
				<div class="col-sm-4">
					<div class="well quickInfo">
						<span class="glyphicon glyphicon-exclamation-sign"></span>
						<div class="text-right info-links">
							<p class="title">Vulnerabilities</p>
							<p class="info"><span class="bold">Total:</span><span id="totalCount"></span></p>
							<ul>
								<li><span class="criticalVulnerability bold">Critical:</span><span id="criticalCount"></span></li>
								<li><span class="highVulnerability bold">High:</span><span id="highCount"></span></li>
								<li><span class="middleVulnerability bold">Middle:</span><span id="middleCount"></span></li>
								<li><span class="lowVulnerability bold">Low:</span><span id="lowCount"></span></li>
								<li><span class="infoVulnerability bold">Informational:</span><span id="informationalCount"></span></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-sm-4">
					<div class="well">
						<h3>Vulnerabilities by criticality</h3>
						<div id="chartVulnerabilitiesByLevel"></div>
						
					</div>
				</div>
				<div class="col-sm-4">
					<div class="well">
						<h3>Vulnerabilities by type</h3>
						<div id="chartVulnerabilitiesByType"></div>
						
					</div>
				</div>
				<div class="col-sm-4">
					<div class="well">
						<h3>Vulnerabilities by target</h3>
						<div id="chartVulnerabilitiesByTarget"  style="width:100%;height:500px;"></div>
						
					</div>
				</div>
			</div>
			
			<div class="row break-after">
				<div class="col-sm-12">
					<div class="table-responsive well">
						<h3 data-anchor="vulnerabilitiesTable">Vulnerabilities</h3>
					  	<table class="table table-bordered" id="tableVulnerabilities">
						    <thead>
					          <tr id="headVulnerability">
					            <th style="width:245px" data-orderColumn="identity" data-orderDirection="asc" >ID <span class="glyphicon glyphicon-chevron-down"></span> <span class="glyphicon glyphicon-chevron-up"></span></th>
					            <th style="width: 60%" data-orderColumn="resource" data-orderDirection="asc">Target<span class="glyphicon glyphicon-chevron-down"></span> <span class="glyphicon glyphicon-chevron-up"></span></th>
					            <th style="width: 40%" data-orderColumn="display_name" data-orderDirection="asc">Vulnerability<span class="glyphicon glyphicon-chevron-down"></span> <span class="glyphicon glyphicon-chevron-up"></span></th>
					            <th style="width:125px" data-orderColumn="level" data-orderDirection="asc" class="sort logicaldesc">Criticality<span class="glyphicon glyphicon-chevron-down"></span> <span class="glyphicon glyphicon-chevron-up"></span></th>
					            <th style="width:58px"></th>
					          </tr>
					          <tr class="filter">
									<th></th>
									<th>
										<select id="targetFilterTable" name="targetFilterTable">

										</select>
									</th>
									<th>
										<select id="vulnerabilityFilterTable" name="vulnerabilityFilterTable">

										</select>
									</th>
									<th>
										<select id="criticalityFilterTable" name="vulnerabilityFilterTable">
											<option value="">All</option>
											<option value="4">Informational</option>
											<option value="3">Low</option>
											<option value="2">Medium</option>
											<option value="1">High</option>
											<option value="0">Critical</option>
										</select>
									</th>
									<th></th>
					        	</tr>
					        </thead>
					        <tbody>
					        </tbody>
					  	</table>
					  	<div >Total: <span id="totalTableVulnerabilities"></span></div>
					</div>
				</div>
			</div>
			<div class="row break-after">
				<div class="col-sm-12">
					<div class="table-responsive well">
						<h3 data-anchor="technicalReportTable">Technical report</h3>
						<span class="pull-right" id="hideShowAll" data-show="true">Hide all</span>
					  	<table class="table table-bordered" id="tableTechnicalReport" >
						   <tbody>
								<tr id="headVulnerability">
									<th style="width:30px" data-orderColumn="id" data-orderDirection="asc"></span></th>
						            <th style="width:245px" data-orderColumn="id" data-orderDirection="asc">ID</span></th>
						            <th style="width: 60%" data-orderColumn="target" data-orderDirection="asc">Target</th>
						            <th style="width: 40%" data-orderColumn="type" data-orderDirection="asc">Vulnerability</th>
						            <th style="width:80px" data-orderColumn="criticality" data-orderDirection="asc">Criticality</th>
						          </tr>
						   </tbody>
					  	</table>
					</div>
				</div>
			</div>
		</div>
		<span class="totop"><a href="#"><i class="glyphicon glyphicon-chevron-up"></i></a></span>




		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	    <script type="text/javascript" src="js/jquery.js"></script>

	    <!-- Include all compiled plugins (below), or include individual files as needed -->
	    <script type="text/javascript" src="js/bootstrap.min.js"></script>
	    <script type="text/javascript" src="js/jquery.jqplot.min.js"></script>
	    <script type="text/javascript" src="js/jqplot.pieRenderer.min.js"></script>
	    <script type="text/javascript" src="js/jquery.tmpl.min.js"></script>
	    <script type="text/javascript" src="js/taffy-min.js"></script>
	    <script type="text/javascript" src="js/dataaccess.js"></script>

	    <!--GoLismero database dumped in JSON format-->
        <script type="text/javascript" src="js/database.js"></script>

	    <!--plantillas para la generacion de codigo html-->
	    <script type="text/template" id="rowVulnerabilityTemplate">
			<tr>
				<td>${identity}</td>
				<td><p class="large" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="${resource}">${resource}</p></td>				
				<td>${display_name}</td>
				<td><span class="bold ${obtainLevel(level)}Vulnerability">${obtainLevel(level)}</span></td>
				<td class="anchor moreInfo" data-href="technical-${identity}">Details</td>
			</tr>
		</script>
		<script type="text/template" id="expandedInfoTechnical">
			<div class="row">
				<div class="col-sm-12">
					<div class="item-form"><span class="bold">Target:</span>${obtainTarget(links[0])}</div>
				</div>
			</div>
			<div class="row">				
				<div class="col-sm-4">
					<div class="item-form"><span class="bold">Vulnerability:</span>${display_name}&nbsp;(${data_subtype}) </div>
				</div>
				<div class="col-sm-4">
					<div class="item-form"><span class="bold ">Criticality:</span><span class="${obtainLevel(level)}Vulnerability bold">${obtainLevel(level)}</span> </div>
				</div>
			</div>
			<div class="row">
				<div class="col-sm-4">
					<div class="item-form"><span class="bold">Plugin ID:</span>${plugin_id}</div> 
				</div>
				<div class="col-sm-4">
					<div class="item-form"><span class="bold">Plugin name:</span>${plugin_name}</div>
				</div>	
				<div class="col-sm-4">
				</div>			
			</div>
			<div class="row">
				<div class="col-sm-4">
					<div class="item-form"><span class="bold">Impact:</span></span>${impact} </div>
				</div>
				<div class="col-sm-4">
					<div class="item-form"><span class="bold">Severity:</span>${severity}</div>
				</div>	
				<div class="col-sm-4">
					<div class="item-form"><span class="bold">Risk:</span>${risk}</div>
				</div>			
			</div>
			
		</script>
		<script type="text/template" id="referencesTechnical">
			<div><a href="${$data}" target="_blank">${$data}</a></div>
		</script>
		<script type="text/template" id="taxonomyTechnical">
			<div>${$data}</div>
		</script>
		
		<script type="text/template" id="tableVulnerabilitiesTechnicalTable">
			<tr data-anchor="technical-${identity}" class="headData expanded" >
				<td><span class="glyphicon glyphicon-plus contracted"></span> <span class="glyphicon glyphicon-minus expanded"></td>
				<td>${identity}</td>
				<td><p class="large">${obtainTarget(links[0])}</p></td>
				<td>${display_name}</td>
				<td><span class="bold ${obtainLevel(level)}Vulnerability">${obtainLevel(level)}</span></td>
			</tr>
			<tr class="openVulnerabilitiesRow"><td colspan="5">
			<div class="row ">
				<div class="col-sm-12">
					<h4>${title}</h4>
					<div class="well">
						{{tmpl($data) "#expandedInfoTechnical"}}
						
					</div>
					{{if taxonomy}}
						<div class="well">
							<span class="bold">Taxonomy:</span>
							{{tmpl(taxonomy) "#taxonomyTechnical"}}
							
						</div>
					{{/if}}	
					{{if description}}
						<div class="well">
							<span class="bold">Description:</span> <pre>${description}</pre>
						</div>
					{{/if}}	
					{{if solution}}
						<div class="well">
							<span class="bold">Solution:</span> <pre>${solution}</pre>
						</div>
					{{/if}}	
					{{if references.length >0}}
						<div class="well">	
							<span class="bold">References:</span>
							{{tmpl(references) "#referencesTechnical"}}
				   		</div>
				   	{{/if}}	
			   	</div>
			   </div>
			 </td></tr>
		</script>
	    <script type="text/javascript">
		
			function obtainLevel(level){
				switch(level){
					case 0: return "critical";
					case 1: return "high";
					case 2: return "middle";
					case 3: return "low";
					case 4: return "informational";
				}
			}
			
			$( window ).resize(function() {
			 initChartByLevel();
			 initChartByType();
			 initChartByTarget();
			});
	    	function initChartByLevel(){
	    		var datachart = dataAccess.getDataChartByLevel();
				var vulnByType = dataAccess.getDataVulnsByLevel();
				
				
	    		$("#criticalCount").html(vulnByType.Critical ? vulnByType.Critical :0);
	    		$("#highCount").html(vulnByType.High ? vulnByType.High :0);
	    		$("#middleCount").html(vulnByType.Middle ? vulnByType.Middle :0);
	    		$("#lowCount").html(vulnByType.Low ? vulnByType.Low :0);
	    		$("#informationalCount").html(vulnByType.Informational ? vulnByType.Informational :0);
	    		$("#totalCount").html((vulnByType.Critical ? vulnByType.Critical :0)+(vulnByType.High ? vulnByType.High :0)+(vulnByType.Middle ? vulnByType.Middle :0)
				+(vulnByType.Low ? vulnByType.Low :0)+(vulnByType.Informational ? vulnByType.Informational :0));
				$("#chartVulnerabilitiesByLevel").empty();
				$("#chartVulnerabilitiesByLevel").css("height", 400+"px");
				  var plot1 = jQuery.jqplot ('chartVulnerabilitiesByLevel', [datachart],
				    {
			            seriesDefaults: {
			              // Make this a pie chart.
			              renderer: jQuery.jqplot.PieRenderer,
			              rendererOptions: {
			                // Put data labels on the pie slices.
			                // By default, labels show the percentage of the slice.
			                showDataLabels: true,
			                dataLabelPositionFactor: 1.15,
							diameter:150
			              }
			            },
			            legend: { show:true, location: 's' },
			            seriesColors : ['#B40A9D','#b00700','#d7ac00', '#019127', '#0080FF'],
			            grid: {drawBorder:false, shadow: false}
			          }
				  );
	    	}
			
			function initChartByType(){
	    		$("#chartVulnerabilitiesByType").empty();
				var data = dataAccess.getDataChartByType();
				$("#chartVulnerabilitiesByType").css("height", (320+(data.length*25))+"px");
				  var plot1 = jQuery.jqplot ('chartVulnerabilitiesByType', [data],
				    {
			            seriesDefaults: {
			              // Make this a pie chart.
			              renderer: jQuery.jqplot.PieRenderer,
			              rendererOptions: {
			                // Put data labels on the pie slices.
			                // By default, labels show the percentage of the slice.
			                showDataLabels: true,
			                dataLabelPositionFactor: 1.15,
							diameter:150
			              }
			            },
			            legend: { show:true, location: 's' },
			            grid: {drawBorder:false, shadow: false}
			          }
				  );
	    	}
			
			function initChartByTarget(){
	    		$("#chartVulnerabilitiesByTarget").empty();
				var data = dataAccess.getDataChartByTarget();
				$("#chartVulnerabilitiesByTarget").css("height", (320+(data.length*25))+"px");
				  var plot1 = jQuery.jqplot ('chartVulnerabilitiesByTarget', [data],
				    {
			            seriesDefaults: {
			              // Make this a pie chart.
			              renderer: jQuery.jqplot.PieRenderer,
			              rendererOptions: {
			                // Put data labels on the pie slices.
			                // By default, labels show the percentage of the slice.
			                showDataLabels: true,							
			                dataLabelPositionFactor: 1.15,
							diameter:150
			              }
			            },
			            legend: { show:true, location: 's'},
			            grid: {drawBorder:false, shadow: false}
			          }
				  );
	    	}
			
	    	function initAnchor(){
				//clic en un enlace de la lista
				$('.anchor').on('click touchstart',function(e){
					e.preventDefault();					
					var strAnchor=$(this).attr('href');
					if($(this).data("href")){
						strAnchor=$(this).data("href");
					}
					$('body,html').stop(true,true).animate({
						scrollTop: $("[data-anchor='"+strAnchor+"']").first().offset().top -80
					},1000);
				});

	    	}
	    	function updateAnchorTable(){
				//clic en un enlace de la lista
				$("#tableVulnerabilities").find('.anchor').on('click touchend',function(e){
					e.preventDefault();
					var strAnchor=$(this).attr('href');
					if($(this).data("href")){
						strAnchor=$(this).data("href");
					}
					$('body,html').stop(true,true).animate({
						scrollTop: $("[data-anchor='"+strAnchor+"']").first().offset().top -80
					},1000);
				});

	    	}


	    	function updateTable(){
	    		$("#tableVulnerabilities tbody").empty();
	    		indexVulnerabilities=0;
	    		var vulnerabilityFilter = $('#vulnerabilityFilterTable').val();
    			var targetFilter = $('#targetFilterTable').val();
    			var criticalityFilter = parseInt($('#criticalityFilterTable').val());
    			var orderColumn = $("#headVulnerability").data("ordercolumn");
    			
	    		var orderDirection = $("#headVulnerability").data("orderdirection");
				
    			var data = dataAccess.getVulnerabilities(targetFilter, vulnerabilityFilter,criticalityFilter, orderColumn, orderDirection);
    			
				$("#tableVulnerabilities tbody").append($.tmpl( "rowVulnerabilityTemplate", data ));
				//cargo el count
				$("#totalTableVulnerabilities").html(dataAccess.getVulnerabilitiesCount(targetFilter,vulnerabilityFilter,criticalityFilter));
    			
    			
    			updateAnchorTable();
    			$("#tableVulnerabilities tbody").find("[data-toggle='tooltip']").tooltip();
	    	}
	    	function initTechnicalTable(){
	    		var data = dataAccess.getTargetTechnical();
	    		$("#tableTechnicalReport tbody").append($.tmpl( "tableVulnerabilitiesTechnicalTable", data ));
	    		$("#tableTechnicalReport tbody").find("tr.headData").on("click touchstart", function(e, data){	    			
	    			var $nextRow = $(this).next();
	    			if(data != undefined){
	    				if(data){
	    					$nextRow.show();
	    					$(this).addClass("expanded").removeClass("contracted");
	    				}else{
	    					$nextRow.hide();
	    					$(this).removeClass("expanded").addClass("contracted");
	    				}
	    			}else{
		    			if($nextRow.is(":visible")){
		    				$nextRow.hide();
		    				$(this).removeClass("expanded").addClass("contracted");
		    			}else{
		    				$nextRow.show();
		    				$(this).addClass("expanded").removeClass("contracted");
		    			}
		    		}
	    		});
	    		$("#hideShowAll").on("click touchstart", function(){
	    			if($(this).data("show")==true){
	    				$("#tableTechnicalReport tbody").find("tr.headData").trigger("click", false);
	    				$(this).data("show", false);
	    				$(this).html("Show all");
	    			}else{
	    				$("#tableTechnicalReport tbody").find("tr.headData").trigger("click", true);
	    				$(this).data("show", true);
	    				$(this).html("Hide all");
	    			}
	    		});
	    	}

	    	
	    	function initVulnerabilitiesTable(){
	    		//vulnerabilities
	    		$('#vulnerabilityFilterTable').append('<option value="">All</option>');
	    		$(dataAccess.getTypeVulnerabilities()).each(function(index,v){
	    			$('#vulnerabilityFilterTable').append('<option value="'+v+'">'+v+'</option>');
	    		});
	    		//targets
	    		$('#targetFilterTable').append('<option value="">All</option>');
	    		$(dataAccess.getAuditScope()).each(function(index,t){
	    			$('#targetFilterTable').append('<option value="'+t+'">'+t+'</option>');
	    		});
	    		$('#targetFilterTable').change(function(e){
	    			updateTable();
	    		});
	    		$('#vulnerabilityFilterTable').change(function(e){
	    			updateTable();
	    		});
	    		$('#criticalityFilterTable').change(function(e){
	    			updateTable();
	    		});
	    		$("#headVulnerability").find("th").on("click touchstart",function(){
	    			column = $(this).data("ordercolumn");
	    			direction = $(this).data("orderdirection");
	    			$("#headVulnerability").data("ordercolumn", column);
	    			$("#headVulnerability").data("orderdirection", direction);
	    			if(direction =="asc"){
	    				$(this).data("orderdirection", "logicaldesc");
	    			}else{
						$(this).data("orderdirection", "asc");
					}

	    			$("#headVulnerability").find("th").removeClass("sort");
	    			$("#headVulnerability").find("th").removeClass("asc");
	    			$("#headVulnerability").find("th").removeClass("desc");
	    			$(this).addClass("sort");
	    			$(this).addClass(direction);
	    			updateTable();
	    		});

	    		updateTable();
    			
	    	}
	    	function initTemplates(){
	    		$.template( "rowVulnerabilityTemplate", $("#rowVulnerabilityTemplate") );
	    		$.template("rowTargetTechnicalTable", $("#rowTargetTechnicalTable"));
	    		$.template("tableVulnerabilitiesTechnicalTable", $("#tableVulnerabilitiesTechnicalTable"));
	    	}
	    	function obtainCriticality(c){
	    			switch (c){
	    			case 1:return "infoVulnerability";
	    			break;
	    			case 2: return "lowVulnerability";
	    			break;
	    			case 3: return "middleVulnerability";
	    			break;
	    			case 4: return "highVulnerability";
	    			break;
	    			case 5: return "criticalVulnerability";
	    			break;
	    		}

	    	}
	    	function obtainTarget(id){
				return dataAccess.getTargetById(id);	    		
	    	}
	    	
	    	function initToTop(){
	    		$(".totop").hide();
				if($(this).scrollTop() > 80){
					//mostrar barra vertical lateral
					$("#lateralNavbar").show();
				}else{
					//ocultar barra
					$("#lateralNavbar").hide();
				}
				$(function(){
					$(window).scroll(function(){
						if($(this).scrollTop() > 80){
							//mostrar barra vertical lateral
							$("#lateralNavbar").show();
						}else{
							//ocultar barra
							$("#lateralNavbar").hide();
						}
						if ($(this).scrollTop()>600)
						{
							$('.totop').slideDown();
						}
						else
						{
							$('.totop').slideUp();
						}
						});

						$('.totop a').on("click touchstart", function (e) {
						e.preventDefault();
						$('body,html').animate({scrollTop: 0}, 500);
					});

				});
	    	}
	    	function initResume(){
	    		$("#startResume").html(data.summary.start_time);
	    		$("#endResume").html(data.summary.stop_time);
	    		$("#totalResume").html(data.summary.run_time);

	    		$(dataAccess.getAuditScope()).each(function(index,v){
	    			$('#targetsResume').append('<li>'+v+';</li>');
	    		});
	    	}
	    	function initLateralMenu(){
	    		$("#lateralNavbar").on("click touchstart", function(){
	    			if($(this).width() >20){
	    				//desplegada
	    				hideLateralMenu();
	    			}else{
	    				showLateralMenu();
	    			}
	    		});
	    		hideLateralMenu = function(){
	    			$( "#lateralNavbar" ).animate({
					    width: "20px"
					 }, {
					    duration: 500,
					   complete: function() {
					     $(this).removeClass("showLateralMenu");
					    }
					  });
	    		};
	    		showLateralMenu = function(){
	    			$( "#lateralNavbar" ).animate({
					    width: "50px"
					 }, {
					    duration: 500,
					   complete: function() {
					     $(this).addClass("showLateralMenu");
					    }
					  });
	    		}
	    		
	    	}
	    	var dataAccess;
	    	var indexVulnerabilities = 0;
	    	$(document).ready(function(){
	    		dataAccess = new DataAccess();
	    		initResume();
	    		initToTop();
				initChartByLevel();
				initChartByType();
				initChartByTarget();
				initAnchor();
				initTemplates();
				initVulnerabilitiesTable();
				initTechnicalTable();
				
				initLateralMenu();
				//colocar mismo alto todos los quickInfo
				var maxHeigth=0;
				$(".quickInfo").each(function(){
					if($(this).outerHeight(false) > maxHeigth){
						maxHeigth= $(this).outerHeight(false);
					}
				});
				if(maxHeigth>220){
					maxHeigth = 220;
				}
				$(".quickInfo").each(function(){
					
					$(this).css("height", maxHeigth+"px");
				});
			});
			
	    </script>
	</body>
</html>